2*pnorm(-abs(z))
s=1.6
t <- (xbar-u)/(s/sqrt(n))
t
2*pt(-abs(t),df=n-1)
qnorm(.05/2)
4.3+(1.96*(.52/8))
4.3-(1.96*(.52/8))
qt(.05/2, 63)
4.3-(2*(1.6/8))
4.3=(2*(1.6/8))
4.3=+(2*(1.6/8))
4.3+(2*(1.6/8))
27+1.96*1.5
6/1.96
combn(12,3)
sum(combn(12,3))
x=c(15,21,26,32,39,40,41,45,52,60,70,82)
length
length(x)
install.packages('combinat')
library(combinat)
permn(x)
sum(combn(12,3))
combn(12,3)
y=combn(12,3)
y2=colSums(y)
length(y2[y2<=12])
y2
y=combn(16,4)
length(y)
y2=colSums(y)
length(y2)
length(y2[y2<=12])
y2
4/1280
View(y)
y
y=combn(16,4)
View(y)
length(y2[y2<=12])
y2[y2<=12]
y2=rowSums(y)
length(y2)
y=combn(16,4)
dim(y)
sum(y[,1])
sum(y[,2])
y[,1]
2*pbinom(0,9,.05)
2*pbinom(0,10,.05)
y<-combn(5,2);table(colSums(y))
y=combn(16,4)
table(colSums(y))
x<-c(49, 58, 75, 110, 112, 132, 151, 276, 281, 362);
num.success<-sum(x>=200);
binom.test(num.success,length(x))
2*pbinom(num.success,length(x),prob=0.5)
2*pbinom(0,10,.5)
2*pbinom(1,9,.5)
2*pbinom(3,9,.5)
y=sum(x<215)
binom.test(y,length(x))
2*pbinom(4,9,.5)
2*pbinom(4,9,.5)
2*pbinom(3,9,.5)
2*pbinom(0,9,.5)
1-(2*pbinom(0,9,.5))
1-(2*pbinom(1,9,.5))
1-(2*pbinom(2,9,.5))
x=ecdf(c(126,142,156,228,245,246,370,419,433))
plot.ecdf(x)
ecdf(x[4])
4/9
8/9
y<-combn(12,3);table(colSums(y))
length(y)
4/660
length(y2[y2<=7])
y<-combn(12,3);y2=(colSums(y))
length(y2[y2<=7])
length(y2)
l=combn(16,4)
length(l)
l2=(colSums(l))
length(l2)
length(y2[y2<=9])
7/660
2*7/660
14/660
y<-combn(12,3);table(colSums(y))
14/660
2*length(y2[y2<=9])/length(y2)
length(y2[y2<=9])/length(y2)
length(y2[y2<=7])/length(y2)
l=combn(16,4)
2*length(l2[yl<=12])/length(l2)
l=combn(16,4)
l<-combn(12,3);l2=(colSums(l))
2*length(l2[l2<=12])/length(l2)
l=combn(16,4)
l<-combn(12,3);l2=(colSums(l))
2*length(l2[l2<=12])/length(l2)
y=combn(16,4);y2=colSums(y);2*length(y2[y2<=12])/length(y2)
y=combn(16,4);y2=colSums(y);2*length(y2[y2<12])/length(y2)
table(colSums(l))
l=combn(16,4)
l<-combn(16,4);l2=(colSums(l))
table(colSums(l))
2*length(l2[l2<=12])/length(l2)
length(l2)
8/1820
length(y2[y2<=7])/length(y2)
y<-combn(12,3);y2=(colSums(y))
length(y2[y2<=7])/length(y2)
4/1280
8/1280
l=combn(16,4)
l<-combn(16,4);l2=(colSums(l))
table(colSums(l))
2*length(l2[l2<=12])/length(l2)
length(l2)
4/1820
pbinom(5,18)
pbinom(5,18,.5)
2*pbinom(5,18,.5)
combn(6,0)
combn(0,6)
.5^0
.5^6
1/31
1/32
2*sqrt((1-8/62)*15.25^2/8)
25.12-10.06
25.12+10.06
155*33.9+62*25.12+93*19
8578.94/(155+62+93)
samp=function(N,sigma,a){
N^2*sigma^2/a
}
samp_1=samp(155,25,1/3)
n=samp(155,25,1/3)+samp(62,225,1/3)+samp(93,100,1/3)
x=samp(155,25,1/3)+samp(62,225,1/3)+samp(93,100,1/3)
x
N1=155;N2=62;N3=93;o1=25;o2=225;o3=100;B=2;a=1/3;
N=N1+N2+N3;
D=B^2/4
n=(N1^2*o1^2/a)/(N^2*D+N1*o1^2)+(N2^2*o2^2/a)/(N^2*D+N2*o2^2)+(N3^2*o3^2/a)/(N^2*D+N3*o3^2)
n
n=(N1^2*o1/a)/(N^2*D+N1*o1)+(N2^2*o2/a)/(N^2*D+N2*o2)+(N3^2*o3/a)/(N^2*D+N3*o3)
n
n=(N1^2*o1/a+N2^2*o2/a+N3^2*o3/a)/(N^2*D+N1*o1+N2*o2+N3*o3)
n
n/3
installed.packages("Demonstrate")
library(Demonstrate)
pnorm(-2.746)
x<-c(39.2, 39.3, 39.4, 42.4, 42.6, 42.8, 42.9, 43.0, 43.1, 43.3, 44.4, 44.6);
wilcox.test(x,mu=15, alternative='two.sided',correct=FALSE,exact=FALSE)
wilcox.test(x,mu=43.9, alternative='less',correct=FALSE,exact=FALSE)
pnorm(-2.706)
wilcox.test(x,mu=43.9, alternative='less',correct=TRUE,exact=FALSE)
x-40
sum(4:12)
1-pnorm(2.5495)
wilcox.test(x,mu=40, alternative='less',correct=TRUE,exact=FALSE)
pnorm(2.5495)
wilcox.test(x,mu=40, alternative='greater',correct=TRUE,exact=FALSE)
x<-c(102,103,111,117,129,116,115,128,110,105);
x<-runif(100,0,100);
boxplot(x)
ks.test(x,"pnorm",mean(x),sd(x)) ;
x<-c(102,103,111,117,129,116,115,128,110,105);
y=runif(10,100,130)
par(mfrow=c(1,2))
boxplot(x,y)
boxplot(x)
dev.off()
boxplot(x,y)
ks.test(x,y,)
ks.test(x,y)
ks.test(x,y,mean(x),sd(x))
ks.test(x,"punif",100,130)
plot.ecdf(ecdf(x),xlim=c(100,130),main="the cdf vs sample cdf for n=10")
abline(100,130,h=c(100,130),v=c(100,130))
x50<-runif(50)
plot.ecdf(ecdf(x50),xlim=c(0,1),main="the cdf vs sample cdf for n=50")
abline(0,1,h=c(0,1),v=c(0,1))
plot.ecdf(ecdf(x),xlim=c(100,130),main="the cdf vs sample cdf for n=10")
abline(100,130,h=c(0,1),v=c(0,1))
abline(100,130)
plot.ecdf(ecdf(x),xlim=c(100,130),main="the cdf vs sample cdf for n=10")
abline(100,130)
abline(0,1)
plot.ecdf(ecdf(x),xlim=c(100,130),main="the cdf vs sample cdf for n=10")
abline(0,1)
abline(0,130)
x<-c(102,103,111,117,129,116,115,128,110,105);
ks.test(x,"punif",100,130)
htest$statistic
ks.test(x,"pnorm",mean(107),sd(20))
ks.test(x,"pnorm",mean=107,sd=20)
ks.test(x,"pnorm",mean(x),sd(x))
mean(x);sd(x)
3.5/(sqrt(10)/2)
pnorm(2.213594)
1-pnorm(2.213594)
(1.5-10)/(sqrt(10)/2)
(1.5-5)/(sqrt(10)/2)
5/9
z=((5/9)-.8)/sqrt(.8*.2/9)
pnorm(z)
median(x)
choose(4,0)
choose(10,5)
2/choose(10,5)
8/252
x=c(128,102,111,117,103,129,110,116,105,115)
median(x)
choose(4,3)
choose(4,4)
(2*5*5*(2*5*5-10))/(10^2*(10-1))
vx=(2*5*5*(2*5*5-10))/(10^2*(10-1))
2.5/sqrt(vx)
z=2.5/sqrt(vx)
2*pnorm(z)
2*(1-pnorm(z))
x=matrix(30,18,5,2, nrow=2, ncol=2)
x=matrix(30,18,5,2, nrow=2, ncol=2)
x
x=matrix(c(30,18,5,2), nrow=2, ncol=2)
x
mcnemar.test(x)
x<-c(102,103,111,117,129,116,115,128,110,105);
plot(ecdf(x));
lines(x, pnorm(x, mean=107,sd=20, type="l", col = "blue")
(1.5-5)/(sqrt(10)/2)
1-pnorm(2.213594)
z=((5/9)-.8)/sqrt(.8*.2/9)
pnorm(z)
median(x)
2/choose(10,5)
8/252
x=c(128,102,111,117,103,129,110,116,105,115)
median(x)
choose(4,4)
vx=(2*5*5*(2*5*5-10))/(10^2*(10-1))
z=2.5/sqrt(vx)
2*(1-pnorm(z))
x=matrix(c(30,18,5,2), nrow=2, ncol=2)
x
mcnemar.test(x)
lines(x, pnorm(x, mean=107,sd=20, type="l", col = "blue")
(1.5-5)/(sqrt(10)/2)
1-pnorm(2.213594)
z=((5/9)-.8)/sqrt(.8*.2/9)
pnorm(z)
median(x)
2/choose(10,5)
8/252
x=c(128,102,111,117,103,129,110,116,105,115)
median(x)
choose(4,4)
vx=(2*5*5*(2*5*5-10))/(10^2*(10-1))
z=2.5/sqrt(vx)
2*(1-pnorm(z))
x=matrix(c(30,18,5,2), nrow=2, ncol=2)
x
mcnemar.test(x)
lines(x, pnorm(x, mean=107,sd=20, type="l", col = "blue");
(1.5-5)/(sqrt(10)/2)
1-pnorm(2.213594)
z=((5/9)-.8)/sqrt(.8*.2/9)
pnorm(z)
median(x)
2/choose(10,5)
8/252
x=c(128,102,111,117,103,129,110,116,105,115)
median(x)
choose(4,4)
vx=(2*5*5*(2*5*5-10))/(10^2*(10-1))
z=2.5/sqrt(vx)
2*(1-pnorm(z))
x=matrix(c(30,18,5,2), nrow=2, ncol=2)
x
mcnemar.test(x)
plot(ecdf(x));
lines(x, pnorm(x, mean=107,sd=20, type="l", col = "blue");
(1.5-5)/(sqrt(10)/2)
1-pnorm(2.213594)
z=((5/9)-.8)/sqrt(.8*.2/9)
pnorm(z)
median(x)
2/choose(10,5)
8/252
x=c(128,102,111,117,103,129,110,116,105,115)
median(x)
choose(4,4)
vx=(2*5*5*(2*5*5-10))/(10^2*(10-1))
z=2.5/sqrt(vx)
2*(1-pnorm(z))
x=matrix(c(30,18,5,2), nrow=2, ncol=2)
x
mcnemar.test(x)
lines(x, pnorm(x, mean=107,sd=20), type="l", col = "blue");
x<-c(102,103,111,117,129,116,115,128,110,105);
plot(ecdf(x));
curve(pnorm(x, mean=107,sd=20),add=T, col = "blue");
4/252
16/252
x1=c(100,100,110,120,120,120)
x=c(100,100,110,120,120,120)
y=c(60,70,70,80,80,150,150,150)
vec<-rank(c(x,y))
m=length(x); n=length(y)
x.rank<-vec[1:m];
y.rank<-vec[(m+1):(m+n)]
Sm=sum(x.rank); print(Sm);
Sn=sum(y.rank); print(Sn);
Um=Sm-m*(m+1)/2
Un=Sn-n*(n+1)/2
z=(51-.5*6*15)/sqrt(48*15/12)
1-pnorm(z)
z=(30-.5*6*8)/sqrt(48*15/12)
1-pnorm(z)
wilcox.test(x,y,alternative="greater")
x=c(102,103,111,117,116,119)
y=c(60,66,70,76,78,146,148,152)
med=median(c(x,y))
pval=factorial(6)*factorial(8)*factorial(7)*factorial(7)/(factorial(4)*factorial(2)*factorial(3)*factorial(5)*factorial(14))
pval
plot(x,y)
par(mfrow=c(1,2))
plot(x);plot(y)
plot(x);lines(x);plot(y);lines(y)
x=c(100,100,110,120,120,120)
y=c(60,70,70,80,80,150,150,150)
vec<-rank(c(x,y))
m=length(x); n=length(y)
x.rank<-vec[1:m];
y.rank<-vec[(m+1):(m+n)]
Sm=sum(x.rank); print(Sm);
Sn=sum(y.rank); print(Sn);
Um=Sm-m*(m+1)/2
Un=Sn-n*(n+1)/2
wilcox.test(x,y,alternative="greater",correct=F,exact=F)
pval=(choose(6,4)*choose(8,3)+choose(6,5)*choose(8,2)+choose(6,6)*choose(8,1))/choose(14,7)
pval
mu=6/(6+8)*(1+2.5*2+4.5*2+6.5*2+8+10*3+13*3)
mu
var_mu=6*8/((6+8)*(6+8-1))*(1^2+2.5^2*2+4.5^2*2+6.5^2*2+8^2+10^2*3+13^2*3)
var_mu=6*8/((6+8)*(6+8-1))*(1^2+2.5^2*2+4.5^2*2+6.5^2*2+8^2+10^2*3+13^2*3)-.25*(6+8)*(6+8+1)^2
var_mu
var_mu=6*8/((6+8)*((6+8-1))*(1^2+2.5^2*2+4.5^2*2+6.5^2*2+8^2+10^2*3+13^2*3)-.25*(6+8)*(6+8+1)^2)
var_mu
var_mu=6*8/((6+8)*((6+8-1))*(1^2+2.5^2*2+4.5^2*2+6.5^2*2+8^2+10^2*3+13^2*3)-(.25*(6+8)*(6+8+1)^2))
var_mu
z=51-mu/sqrt(var_mu)
x=c(102,103,111,117,116,119)
y=c(60,66,70,76,78,146,148,152)
vec<-rank(c(x,y))
m=length(x); n=length(y)
x.rank<-vec[1:m];
y.rank<-vec[(m+1):(m+n)]
Sm=sum(x.rank); print(Sm);
Sn=sum(y.rank); print(Sn);
Um=Sm-m*(m+1)/2
Un=Sn-n*(n+1)/2
wilcox.test(x,y,alternative="greater")
plot(ecdf(x));lines(x);plot(ecdf(y));lines(y)
1-pnorm(.7878)
1-pnorm(.7841)
x <- c(102,103,111,117,116,119)
y <- c(60,66,70,76,78,146,148,152)
plot(ecdf(x),xlim=c(101,120));
lines(ecdf(y))
plot(ecdf(x),xlim=c(50,175));
lines(ecdf(y))
plot(ecdf(x),col="red");
lines(ecdf(y),col="green")
plot(ecdf(x),col="red",xlim=c(60,152));
lines(ecdf(y),col="green")
ks.test(x,y,alternative="two-sided",exact=F)
ks.test(x,y,alternative="two.sided",exact=F)
x <- c(20, 23, 34)
y <- c(33, 50)
z <- c(45, 55, 56,79)
w<-c(58, 81,89)
nx=length(x);
ny=length(y);
nz=length(z);
nw=length(w);
N=nx+ny+nz+nw;
xr<-rank(c(x,y,z,w))[1:nx]
yr<-rank(c(x,y,z,w))[(nx+1):(nx+ny)]
zr<-rank(c(x,y,z,w))[(nx+ny+nz+1):(nx+ny+nz)]
zw=rank(c(x,y,z,w))[(nx+ny+nz+nw+1):N]
sk<-(sum(xr))^2/nx+(sum(yr))^2/ny+(sum(zr))^2/nz+(sum(zw))^2/nw
T<- sk*12/(N*(N+1))-3*(N+1)
1-pchisq(T,2)
7^2/3+9^2/2+30^2/4+32^2/3
(12*623.1667/(12*13))-3*13
x <- c(20, 23, 34)
y <- c(33, 50)
z <- c(45, 55, 56,79)
w <- c(58, 81,89)
nx=length(x);
ny=length(y);
nz=length(z);
nw=length(w);
N=nx+ny+nz+nw;
xr<-rank(c(x,y,z,w))[1:nx]
yr<-rank(c(x,y,z,w))[(nx+1):(nx+ny)]
zr<-rank(c(x,y,z,w))[(nx+ny+1):(nx+ny+nz)]
zw =rank(c(x,y,z,w))[(nx+ny+nw+1):N]
sk<-(sum(xr))^2/nx+(sum(yr))^2/ny+(sum(zr))^2/nz+(sum(zw))^2/nw
T<- sk*12/(N*(N+1))-3*(N+1)
1-pchisq(T,3)
1-pchisq(8.9359,3)
kruskal.test(list(x, y, z,w));
6+7+9
/3
22/3
7+8+9
6.5^2/3+9^2/2+32^2/4+30.5^2/3
6.5^2+9^2+32^2+30.5^2
12*13^2/4
11*(620.6667-507)/(2077.5-507)
1-pchisq(.7961,3)
x <- c(20, 20, 30)
y <- c(30, 50)
z <- c(50, 60, 60, 80)
w <- c(60, 80, 90)
kruskal.test(list(x, y, z,w));
1.5^2*2+3.5^2*2+5.5^2*2+8^2*3+10.5^2*2+12
12*13^2/4
11*(620.6667-514)/(507-514)
11*(620.6667-507)/(514-507)
1-pchisq(178.6191,3)
6.5^2/3+9^2/2+32^2/4+30.5^2/3
1.5^2*2+3.5^2*2+5.5^2*2+8^2*3+10.5^2*2+12
12*13^2/4
11*(620.6667-507)/(514-507)
1.5^2*2+3.5^2*2+5.5^2*2+8^2*3+10.5^2*2+12
178/9
5+7+11+12+9+6
U=5+7+11+12+9+6
E_U=12^2-(3^2+2^2+4^2+3^2)
V_U=((12^2*(2*12-3))-((3^2*(2*3+3))+(2^2*(2*2+3))+(4^2*(2*4+3))+(3^2*(2*3+3))))/72
z=(U-E_U)/V_U
pnorm(z)
z=(U-E_U)/sqrt(V_U)
pnorm(z)
x <- c(20, 23, 34)
y <- c(33, 50)
z <- c(45, 55, 56,79)
w <- c(58, 81,89)
install.packages("clinfun")
library(clinfun)
jog=list(x,y,z,w)
n<-c(3,2,4,3)
grp<-as.ordered(factor(rep(1:length(n),n)))
jonckheere.test(unlist(job),grp,alternative="increasing")
jonckheere.test(unlist(jog),grp,alternative="increasing")
11*(620.6667-507)/(646-507)
1.5^2*2+3.5^2*2+5.5^2*2+8^2*3+10.5^2*2+12^2
1-pchisq(8.9952,3)
V_U=((12^2*(2*12-3))-((3^2*(2*3+3))+(2^2*(2*2+3))+(4^2*(2*4+3))+(3^2*(2*3+3))))/12
587/12
E_U=(12^2-(3^2+2^2+4^2+3^2))/4
V_U=((12^2*(2*12-3))-((3^2*(2*3+3))+(2^2*(2*2+3))+(4^2*(2*4+3))+(3^2*(2*3+3))))/12
z=(U-E_U)/sqrt(V_U)
V_U=((12^2*(2*12+3))-((3^2*(2*3+3))+(2^2*(2*2+3))+(4^2*(2*4+3))+(3^2*(2*3+3))))/12
z=(U-E_U)/sqrt(V_U)
V_U=((12^2*(2*12+3))-((3^2*(2*3+3))+(2^2*(2*2+3))+(4^2*(2*4+3))+(3^2*(2*3+3))))/12
V_U=((12^2*(2*12+3))-((3^2*(2*3+3))+(2^2*(2*2+3))+(4^2*(2*4+3))+(3^2*(2*3+3))))/72
z=(U-E_U)/sqrt(V_U)
z=(U-E_U)/sqrt(V_U)
pnorm(-z)
shiny::runApp('Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
runApp('Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
runApp('Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
runApp('Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
Demonstrate2("~/Stapleton_Lab/Projects/Visualization/Demonstrate/Plink Results", make.pos.plot=TRUE, pos.plot.title="True Positives by False Positives",
make.error.plot=TRUE, error.plot.title="Plot of AUC by MAE", extra.plots=TRUE,
AUC.axis.min=0, AUC.axis.max=1.0, MAE.axis.min=0, MAE.axis.max=2.0)
library(DemoMPlot)
Demonstrate2("~/Stapleton_Lab/Projects/Visualization/Demonstrate/Plink Results", make.pos.plot=TRUE, pos.plot.title="True Positives by False Positives",
make.error.plot=TRUE, error.plot.title="Plot of AUC by MAE", extra.plots=TRUE,
AUC.axis.min=0, AUC.axis.max=1.0, MAE.axis.min=0, MAE.axis.max=2.0)
library(plyr)
library(ggplot2)
library(DemoMPlot)
Demonstrate2("~/Stapleton_Lab/Projects/Visualization/Demonstrate/Plink Results", make.pos.plot=TRUE, pos.plot.title="True Positives by False Positives",
make.error.plot=TRUE, error.plot.title="Plot of AUC by MAE", extra.plots=TRUE,
AUC.axis.min=0, AUC.axis.max=1.0, MAE.axis.min=0, MAE.axis.max=2.0)
Demonstrate2("~/Stapleton_Lab/Projects/Visualization/Demonstrate/Winnow Results", make.pos.plot=TRUE, pos.plot.title="True Positives by False Positives",
make.error.plot=TRUE, error.plot.title="Plot of AUC by MAE", extra.plots=TRUE,
AUC.axis.min=0, AUC.axis.max=1.0, MAE.axis.min=0, MAE.axis.max=2.0)
Demonstrate2("~/Stapleton_Lab/Projects/Visualization/Demonstrate/Winnow Results", make.pos.plot=TRUE, pos.plot.title="True Positives by False Positives",
make.error.plot=TRUE, error.plot.title="Plot of AUC by MAE", extra.plots=TRUE,
AUC.axis.min=0, AUC.axis.max=1.0, MAE.axis.min=0, MAE.axis.max=2.0)
MINOTAUR()
library(MINOTAUR)
MINOTAUR()
runApp('~/Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
runApp('~/Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
runApp('~/Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
install.packages("shinythemes")
runApp('~/Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-app')
runApp('~/Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-dashboard')
runApp('~/Stapleton_Lab/Projects/Visualization/ShinyApps/winnow-dashboard')
